<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-icons/maps-icons.html">
<link rel="import" href="../bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu-light.html">
<link rel="import" href="../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="app-styles.html">



<dom-module id="my-summary">
  <template>
    <style include="app-styles">
      :host {
          margin-top: 10%;
      }

      .container{
        border: 1px solid #ccc!important;
        border-radius: 16px;
        padding: 0.01em 16px;
        margin: 25px;
      }

      .title_info{
        color: #ff8300;
        margin-top: 0;
      }

      .hidden{
        display: none;
      }
      dd{
        font-weight: bold;
      }
      a img{
        width: 40px;
        height: 40px;
      }
      img{
        width: 100px;
        height: 100px;
      }
      .container__personal{
        display: grid;
        grid-template-columns: 1fr 1fr;
      }
      .title {
        border-bottom: 1px solid;
        margin-bottom: 40px;
      }
      form {
        display: grid;
        justify-content: center;
      }
      .container-modal {
        text-align: center;
      }
    </style>
    <h1 class="data-header-name">Resumen</h1>

    <div class="container">
      <h2 class="title_info">Información Personal</h2>
      <div class="container__personal">
        <dl>
          <dt>Imagen</dt>
          <dd><img src="[[data.personalInfo.userImage]]" alt="Usuario"></dd>
          <dt>Nombre</dt>
          <dd>[[data.personalInfo.userName]]</dd>
          <dt>Apellido Paterno</dt>
          <dd>[[data.personalInfo.userSurname]]</dd>
          <dt>Apellido Materno</dt>
          <dd>[[data.personalInfo.userLastname]]</dd>
          <dt>Sexo</dt>
          <dd>[[_getSex(data.personalInfo.userSex)]]</dd>
          <dt>Curp</dt>
          <dd>[[data.personalInfo.userCurp]]</dd>
          <dt>RFC</dt>
          <dd>[[data.personalInfo.userRFC]]</dd>
          <dt>Numero Seguro Social</dt>
          <dd>[[data.personalInfo.userEnsurance]]</dd>
          <dt>Estado Civil</dt>
          <dd>[[_getMaritalStatus(data.personalInfo.maritalStatus)]]</dd>
          <dt>Fecha Nacimiento</dt>
          <dd>[[data.personalInfo.userBirthday]]</dd>
        </dl>
        <dl>
          <dt>Meta Profesional</dt>
          <dd>[[data.personalInfo.professionalGoal]]</dd>
          <dt>Calle</dt>
          <dd>[[data.personalInfo.userAddressStreet]]</dd>
          <dt>Numero</dt>
          <dd>[[data.personalInfo.userAddressOutsideNumber]]</dd>
          <dt>Numero Interior</dt>
          <dd>[[data.personalInfo.userAddressInsideNumber]]</dd>
          <dt>Colonia</dt>
          <dd>[[data.personalInfo.userAddressNeighborhood]]</dd>
          <dt>Código Postal</dt>
          <dd>[[data.personalInfo.userAddressPC]]</dd>
          <dt>Ciudad</dt>
          <dd>[[data.personalInfo.userAddressCity]]</dd>
          <dt>Telefonos</dt>
          <template is="dom-repeat" items="{{data.personalInfo.phones}}" as="item">
            <dd>[[item]]</dd>
          </template>
          <dt>Emails</dt>
          <template is="dom-repeat" items="{{data.personalInfo.emails}}" as="item">
            <dd>[[item]]</dd>
          </template>
          <dt>Linkedin</dt>
          <dd> <a href="[[data.personalInfo.userLinkedIn]]"><img src="../assets/img/linkedin.png" alt="Linkedin"></a></dd>
        </dl>
      </div>
    </div>

    <div class="container">
      <h2 class="title_info">Formación</h2>
      <dl>
        <template class="hidden" is="dom-repeat" items="{{data.formation}}" as="item">
          <dt>Institución</dt>
          <dd>[[item.institucion]]</dd>
          <dt>Titulación</dt>
          <dd>[[item.titulacion]]</dd>
          <dt>Estatus</dt>
          <dd>[[item.level]]</dd>
          <dt>En curso</dt>
          <template class="hidden" is="dom-if" if="[[item.actual]]">
            <dd>Si</dd>
          </template>
          <template class="hidden" is="dom-if" if="[[!item.actual]]">
            <dd>No</dd>
          </template>
          <dt>Inicio</dt>
          <dd>[[item.desde]]</dd>
          <dt>Fin</dt>
          <dd>[[item.hasta]]</dd>
        </template>
      </dl>
    </div>

      <div class="container">
        <h2 class="title_info">Experiencia</h2>
        <dl>
          <template class="hidden" is="dom-repeat" items="{{data.experience}}" as="item">
            <dt>Compañia</dt>
            <dd>[[item.company]]</dd>
            <dt>Posición</dt>
            <dd>[[item.position]]</dd>
            <dt>Localización</dt>
            <dd>[[item.location]]</dd>
            <dt>Descripción</dt>
            <dd>[[item.description]]</dd>
            <dt>Fecha Inicial</dt>
            <dd>[[item.startDate]]</dd>
            <dt>Fecha Final</dt>
            <dd>[[item.finalDate]]</dd>
            <dt>Es tu trabajo actual</dt>
            <template class="hidden" is="dom-if" if="[[item.actual]]">
              <dd>Si</dd>
            </template>
            <template class="hidden" is="dom-if" if="[[!item.actual]]">
              <dd>No</dd>
            </template>
          </template>
        </dl>
      </div>

      <div class="container">
        <h2 class="title_info">Conocimientos</h2>
        <dl>
          <dt>Conocimiento - Porcentaje</dt>
          <template class="hidden" is="dom-repeat" items="{{data.knowledges}}" as="item">
            <dd>[[item.knowledge]] - [[item.percent]]</dd>
          </template>
        </dl>
      </div>

      <div class="container">
        <h2 class="title_info">Aptitudes</h2>
        <dl>
          <dt>Aptitud</dt>
          <template class="hidden" is="dom-repeat" items="{{data.skills}}" as="item">
            <dd>[[item]]</dd>
          </template>
        </dl>
      </div>

      <div class="container">
        <h2 class="title_info">Idiomas</h2>
        <dl>
          <dt>Idioma - Nivel</dt>
          <template class="hidden" is="dom-repeat" items="{{data.languages}}" as="item">
            <dd>[[item.name]] - [[item.level]]</dd>
          </template>
        </dl>
      </div>


    <div class="container">
      <h2 class="title_info">Certificaciones</h2>
      <dl>
        <template class="hidden" is="dom-repeat" items="{{data.certifications}}" as="item">
          <dt>Nombre de Certificación</dt>
          <dd>[[item.nombre]]</dd>
          <dt>Empresa</dt>
          <dd>[[item.entidad]]</dd>
          <dt>Licencia</dt>
          <dd>[[item.licencia]]</dd>
          <dt>Inicio</dt>
          <dd>[[item.fechaInicio]]</dd>
          <dt>Fin</dt>
          <dd>[[item.fechaFin]]</dd>
          <dt>Es permanente tu Licencia</dt>
          <template class="hidden" is="dom-if" if="[[item.permanente]]">
            <dd>Si</dd>
          </template>
          <template class="hidden" is="dom-if" if="[[!item.permanente]]">
            <dd>No</dd>
          </template>
        </template>
      </dl>
    </div>
    <paper-button class="paper-button-k save-and-continue" raised on-click="_openModal">Generar PDF</paper-button>

    <paper-dialog id="modal" modal>
      <div class="title">
        <h2>Mi Kurriculum</h2>
      </div>
      <div class="container-modal">
        <h3>Selecciona una plantilla y tipo de formato.</h3>
        <iron-form id="formPrint">
          <form action="/" method="get">
            <paper-dropdown-menu-light name="template" label="Tipo de plantilla" required>
              <paper-listbox slot="dropdown-content" class="dropdown-content" selected={{template}} attr-for-selected="myvalue" required>
                <template is="dom-repeat" items="[[templates]]" as="itemTemplate">
                    <paper-item myvalue="[[itemTemplate]]">{{itemTemplate}}</paper-item>
                </template>
              </paper-listbox>
            </paper-dropdown-menu-light>
            <paper-dropdown-menu-light name="printType" label="Formato" required>
              <paper-listbox slot="dropdown-content" class="dropdown-content" selected={{printType}} attr-for-selected="myvalue" required>
                <template is="dom-repeat" items="[[printTypes]]" as="itemsType">
                    <paper-item myvalue="[[itemsType]]">{{itemsType}}</paper-item>
                </template>
              </paper-listbox>
            </paper-dropdown-menu-light>
          </form>
        </iron-form>
      </div>
      <div class="buttons">
        <paper-button class="paper-button-k save-and-continue" raised dialog-confirm>Cancelar</paper-button>
        <paper-button class="paper-button-k save-and-continue" raised on-tap="_downloadCv">Aceptar</paper-button>
      </div>
    </paper-dialog>
  </template>

  <script>
    /**
     * `my-summary`
     *
     *
     * @customElement
     * @polymer
     *
     */
    class MySummary extends Polymer.Element {
      static get is() { return 'my-summary'; }
      static get properties() {
        return {
          data: {
            type: Object
          },
          templates: {
            type: Array,
            value: ['Agile', 'Development', 'DevOps', 'UX']
          },
          printTypes: {
            type: Array,
            value: ['Básico', 'Completo']
          }
        }
      };

      _getMaritalStatus(id){
        let maritalStatus = {
          1:"Soltero",
          2:"Casado",
          3:"Divorciado"
        }
        return maritalStatus[id];
      }

      _getSex(id){
        let userSex = {M:"Hombre",W:"Mujer"};
        return userSex[id];
      }

      _openModal(){
        this.$.modal.open();
      }

      _downloadCv(event) {
        const validate = this.$.formPrint.validate();
        if (validate) {
          const detail = {
            data: this.data,
            template: this.$.formPrint.serializeForm()
          }
          this._dispatchEvent(event, detail)
        }
      }

      _dispatchEvent(event, detail) {
        this.dispatchEvent(new CustomEvent('download-cv',{
            bubbles: true,
            detail: detail
        }));
      }
    }

    window.customElements.define(MySummary.is, MySummary);
  </script>
</dom-module>
